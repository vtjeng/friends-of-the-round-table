(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     51529,       1404]
NotebookOptionsPosition[     50858,       1378]
NotebookOutlinePosition[     51222,       1394]
CellTagsIndexPosition[     51179,       1391]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"pairs", ":", " ", 
      RowBox[{"(", 
       RowBox[{"seatingArrangment", " ", ":", " ", 
        RowBox[{"int", " ", 
         RowBox[{"List", ".", "t"}]}]}], " ", ")"}]}], " ", "\[Rule]", " ", 
     RowBox[{"int", " ", 
      RowBox[{"List2", ".", "t"}], " ", 
      RowBox[{"List", ".", "t"}], " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"seatingArrangement", " ", ":", " ", 
       RowBox[{
       "List", " ", "of", " ", "ints", " ", "representing", " ", "the", " ", 
        "seating", " ", "arrangement", " ", "around", " ", "a", " ", 
        "circular", " ", "table"}]}]}]}], ",", " ", 
    RowBox[{
    "each", " ", "int", " ", "corresponding", " ", "to", " ", "the", " ", 
     "ID", " ", "of", " ", "an", " ", 
     RowBox[{"individual", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"returns", ":", " ", 
       RowBox[{
       "List", " ", "of", " ", "pairs", " ", "of", " ", "IDs", " ", "of", " ",
         "individuals", " ", "who", " ", "are", " ", "adjacent", " ", "in", 
        " ", "the", " ", "current", " ", "seating", " ", 
        "arrangmenet"}]}]}]}]}], "\[IndentingNewLine]", " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pairs", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "seatingArrangement", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"Partition", "[", 
          RowBox[{"seatingArrangement", ",", "2", ",", "1", ",", "1"}], 
          "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"immutableSwap", ":", " ", 
       RowBox[{"(", 
        RowBox[{"seatingArrangement", " ", ":", " ", 
         RowBox[{"int", " ", 
          RowBox[{"List", ".", "t"}]}]}], ")"}]}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", ":", " ", "int"}], ")"}], " ", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"j", " ", ":", " ", "int"}], ")"}], " ", "\[Rule]", " ", 
        RowBox[{"int", " ", 
         RowBox[{"List", ".", "t"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"seatingArrangement", " ", ":", " ", 
          RowBox[{
          "List", " ", "of", " ", "ints", " ", "representing", " ", "the", 
           " ", "seating", " ", "arrangement", " ", "around", " ", "a", " ", 
           "circular", " ", "table"}]}]}]}]}]}], ",", " ", 
     RowBox[{
     "each", " ", "int", " ", "corresponding", " ", "to", " ", "the", " ", 
      "ID", " ", "of", " ", "an", " ", 
      RowBox[{"individual", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"returns", " ", ":", " ", 
        RowBox[{
        "a", " ", "list", " ", "with", " ", "the", " ", "position", " ", "of",
          " ", "the", " ", "elements", " ", "at", " ", "position", " ", "i", 
         " ", "and", " ", "j", " ", "of", " ", "seatingArrangment", " ", 
         RowBox[{"swapped", "."}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"immutableSwap", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", "#"}], "]"}], "&"}], "@", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"list", ",", "i", ",", "j"}], "}"}], ",", 
        RowBox[{
         RowBox[{"x", "=", "list"}], ";", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"j", ",", "i"}], "}"}], "]"}], "]"}], "=", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], "]"}], "]"}]}], ";", "x"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"swapScore", ":", " ", 
       RowBox[{"(", 
        RowBox[{"currentSeatingArrangement", " ", ":", " ", 
         RowBox[{"int", " ", 
          RowBox[{"List", ".", "t"}]}]}], ")"}]}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"currentFriends", ":", " ", 
         RowBox[{"int", " ", 
          RowBox[{"List2", ".", "t"}], " ", 
          RowBox[{"List", ".", "t"}]}]}], ")"}], " ", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"currentSwop", " ", "int", " ", 
          RowBox[{"List2", ".", "t"}]}], ")"}], " ", "\[Rule]", "  ", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"returns", ":", " ", 
         RowBox[{
         "Given", " ", "the", " ", "currentSeatingArrangement", " ", "and", 
          " ", "the", " ", "pairs", " ", "of", " ", "individuals", " ", "who",
           " ", "are", " ", "already", " ", "friends", " ", "in", " ", 
          "currentFriends"}]}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "determines", " ", "the", " ", "number", " ", "of", " ", "additional", 
       " ", "friend"}], "-", 
      RowBox[{
      "pairs", " ", "that", " ", "will", " ", "be", " ", "generated", " ", 
       "by", " ", "this", " ", 
       RowBox[{"swop", "."}]}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"swapScore", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", "#"}], "]"}], "&"}], "@", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "currentSeatingArrangement", ",", "currentFriends", ",", 
          "currentSwop"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "=", "currentSwop"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Length", "@", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"pairs", "[", 
             RowBox[{"immutableSwap", "[", 
              RowBox[{"currentSeatingArrangement", ",", "i", ",", "j"}], 
              "]"}], "]"}], ",", "currentFriends"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "candidateSwops", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"candidateSwops", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"candidateSwops", "[", "n", "]"}], "=", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"Range", "[", "n", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.614294616991278*^9, 3.6142946185834093`*^9}, {
  3.6142954063268275`*^9, 3.614295407767851*^9}, {3.614382307482106*^9, 
  3.61438230771027*^9}, {3.6143823400222335`*^9, 3.6143823461575904`*^9}, {
  3.6143825678129916`*^9, 3.6143825983116503`*^9}, {3.6153753813195376`*^9, 
  3.6153753820010204`*^9}, {3.61537589875357*^9, 3.6153758991748686`*^9}, {
  3.615378138691646*^9, 3.6153781389678264`*^9}, {3.6549765010341187`*^9, 
  3.6549767831469097`*^9}, {3.654976823600457*^9, 3.654977038649892*^9}, {
  3.654977082166095*^9, 3.654977167995243*^9}, {3.654977275152708*^9, 
  3.654977354200529*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"searchTemplate", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "nextPair"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"curSeatingArrangement", "=", 
        RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"curFriends", "=", 
        RowBox[{"pairs", "[", "curSeatingArrangement", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"swops", "=", 
        RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "curFriends", "]"}], "<", 
           RowBox[{"Binomial", "[", 
            RowBox[{"n", ",", "2"}], "]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], "=", 
           RowBox[{"nextPair", "[", 
            RowBox[{
            "n", ",", "curFriends", ",", " ", "curSeatingArrangement"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"swops", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"curSeatingArrangement", "=", 
           RowBox[{"immutableSwap", "[", 
            RowBox[{"curSeatingArrangement", ",", "i", ",", "j"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"curFriends", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"curFriends", ",", 
             RowBox[{"pairs", "[", "curSeatingArrangement", "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "swops"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"searchTemplateFailFast", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "nextPair", ",", "numSwopsLimit"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"curSeatingArrangement", "=", 
        RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"curFriends", "=", 
        RowBox[{"pairs", "[", "curSeatingArrangement", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"swops", "=", 
        RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "curFriends", "]"}], "<", 
            RowBox[{"Binomial", "[", 
             RowBox[{"n", ",", "2"}], "]"}]}], ")"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "swops", "]"}], "<=", "numSwopsLimit"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], "=", 
           RowBox[{"nextPair", "[", 
            RowBox[{
            "n", ",", "curFriends", ",", " ", "curSeatingArrangement"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"swops", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"curSeatingArrangement", "=", 
           RowBox[{"immutableSwap", "[", 
            RowBox[{"curSeatingArrangement", ",", "i", ",", "j"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"curFriends", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"curFriends", ",", 
             RowBox[{"pairs", "[", "curSeatingArrangement", "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "swops"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "So", " ", "here", " ", "I", " ", "ran", " ", "into", " ", "the", " ", 
    "problem", " ", "where", " ", "randomNextPair", " ", "really", " ", 
    RowBox[{"doesn", "'"}], "t", " ", "care", " ", "about", " ", 
    RowBox[{"curFriends", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"randomNextPair", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", " ", "curFriends", ",", " ", "curSeatingArrangement"}], 
       "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", "2"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"abstractScoredNextPair", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "curFriends", ",", "curSeatingArrangement", ",", 
        "scoreToWeight"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"candidateScores", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"swapScore", "[", 
            RowBox[{"curSeatingArrangement", ",", "curFriends", ",", "#"}], 
            "]"}], "&"}], ",", 
          RowBox[{"candidateSwops", "[", "n", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"candidateWeights", " ", "=", " ", 
        RowBox[{"scoreToWeight", "[", "candidateScores", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{"candidateWeights", "\[Rule]", 
         RowBox[{"candidateSwops", "[", "n", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"greedyScoreToWeight", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "candidateScores", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bestScore", "=", 
        RowBox[{"Max", "[", "candidateScores", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"candidateWeights", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "bestScore"}], ",", "1", ",", "0"}], 
            "]"}], "&"}], ",", "candidateScores"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kindaGreedyScoreToWeight", " ", "=", " ", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "candidateScores", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"candidateWeights", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"3", "*", "#"}], "]"}], "&"}], ",", " ", 
         "candidateScores"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"greedyNextPair", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "curFriends", ",", " ", "curSeatingArrangement"}], "}"}],
      ",", " ", "\[IndentingNewLine]", 
     RowBox[{"abstractScoredNextPair", "[", 
      RowBox[{
      "n", ",", "curFriends", ",", "curSeatingArrangement", ",", 
       "greedyScoreToWeight"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kindaGreedyNextPair", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "curFriends", ",", " ", "curSeatingArrangement"}], "}"}],
      ",", " ", "\[IndentingNewLine]", 
     RowBox[{"abstractScoredNextPair", "[", 
      RowBox[{
      "n", ",", "curFriends", ",", "curSeatingArrangement", ",", 
       "kindaGreedyScoreToWeight"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.615376880864244*^9, 3.615376954957774*^9}, {
   3.6153770384950285`*^9, 3.615377055483077*^9}, 3.6153772295005136`*^9, {
   3.6153773605094423`*^9, 3.6153774048809185`*^9}, {3.6153781482494087`*^9, 
   3.6153781603329797`*^9}, 3.6153782487937536`*^9, {3.615387534964053*^9, 
   3.615387540960241*^9}, 3.615388305004255*^9, {3.615391476135686*^9, 
   3.6153915464608755`*^9}, {3.6153915828780355`*^9, 
   3.6153916749223804`*^9}, {3.615391713649987*^9, 3.615391762290436*^9}, {
   3.615392131062948*^9, 3.615392131197976*^9}, {3.615392356082284*^9, 
   3.6153923703350916`*^9}, {3.654977666594885*^9, 3.6549777641897964`*^9}, {
   3.654978041492713*^9, 3.6549780527116137`*^9}, {3.654978117228007*^9, 
   3.654978137165745*^9}, {3.654978172728651*^9, 3.6549781806974936`*^9}, {
   3.6549782286199584`*^9, 3.654978233166868*^9}, {3.6549782973864136`*^9, 
   3.6549783612152786`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterator", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "numSamples", ",", "nextPair"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"upperBound", "=", 
       RowBox[{"Binomial", "[", 
        RowBox[{"n", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"marker", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"currentCandidate", "=", 
          RowBox[{"searchTemplate", "[", 
           RowBox[{"n", ",", "nextPair"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "currentCandidate"}], "<", "upperBound"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "marker", " ", "is", " ", "the", " ", "number", " ", "of", " ", 
             "improvements", " ", 
             RowBox[{"we", "'"}], "ve", " ", "made", " ", "so", " ", 
             RowBox[{"far", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"marker", "=", 
             RowBox[{"marker", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"upperBound", "=", 
             RowBox[{"Length", "@", "currentCandidate"}]}], ";", " ", 
            RowBox[{"bestCandidate", "=", "currentCandidate"}]}]}], "]"}], 
         ";"}], ",", 
        RowBox[{"{", "numSamples", "}"}]}], "]"}], ";", "\[IndentingNewLine]",
       "bestCandidate"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.614383484236802*^9, 3.614383496068226*^9}, {
  3.6153752913157015`*^9, 3.6153753051255083`*^9}, {3.6153755501432896`*^9, 
  3.6153755521477118`*^9}, {3.615388362795639*^9, 3.6153883678416023`*^9}, {
  3.6153912120899916`*^9, 3.615391222397019*^9}, {3.615490517211478*^9, 
  3.615490523036624*^9}, {3.6155046895013094`*^9, 3.615504689713458*^9}, {
  3.6549774679987707`*^9, 3.6549774785770025`*^9}, {3.65497798041389*^9, 
  3.6549779858983617`*^9}, {3.6549783707310677`*^9, 3.654978371996711*^9}, {
  3.654978460817065*^9, 3.654978462082703*^9}, {3.6549787256483107`*^9, 
  3.654978730210836*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "bestCandidate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"{", 
   RowBox[{"upperBound", ",", "bestCandidate", ",", "marker"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "@", 
  RowBox[{"iterator", "[", 
   RowBox[{"20", ",", "10", ",", " ", "greedyNextPair"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6143835245063934`*^9, 3.61438353996237*^9}, {
   3.6143835717819657`*^9, 3.614383610712612*^9}, {3.614383713040281*^9, 
   3.61438371316938*^9}, {3.614383788937185*^9, 3.6143837890502663`*^9}, {
   3.6153747146668572`*^9, 3.615374718257426*^9}, {3.615374850156963*^9, 
   3.615374853018798*^9}, {3.615374958214423*^9, 3.615374958596706*^9}, {
   3.6153750141811156`*^9, 3.615375014595438*^9}, {3.615375313597508*^9, 
   3.615375319955027*^9}, {3.6153754500823126`*^9, 3.61537545082084*^9}, {
   3.6153755034251504`*^9, 3.615375524972437*^9}, {3.6153755563176985`*^9, 
   3.6153755571002264`*^9}, 3.615375708541648*^9, {3.6153764089024363`*^9, 
   3.6153764099011445`*^9}, {3.6153873176987085`*^9, 3.615387318636166*^9}, {
   3.6153874387651453`*^9, 3.615387462579829*^9}, {3.615388396912348*^9, 
   3.6153884259530277`*^9}, {3.61539116652104*^9, 3.6153911788634653`*^9}, {
   3.6153912295184183`*^9, 3.6153912301635523`*^9}, {3.615391285824519*^9, 
   3.615391288220014*^9}, {3.6153923456952705`*^9, 3.615392346750458*^9}, {
   3.6153923876484914`*^9, 3.6153923878185244`*^9}, {3.6153924262910967`*^9, 
   3.6153924282564754`*^9}, {3.6153924645886183`*^9, 3.615392464803658*^9}, {
   3.6153925110227466`*^9, 3.615392513898311*^9}, {3.615394695167061*^9, 
   3.6153947194642253`*^9}, {3.615394864028399*^9, 3.615394864169073*^9}, {
   3.615490601248294*^9, 3.6154906076778736`*^9}, {3.615503373537553*^9, 
   3.615503373937836*^9}, {3.6155046970857077`*^9, 3.6155047023114276`*^9}, 
   3.6155047687897463`*^9, {3.6155048298682213`*^9, 3.615504839535103*^9}, {
   3.615504885978155*^9, 3.6155048861032486`*^9}, {3.6155051323064957`*^9, 
   3.6155051326117134`*^9}, 3.6549774526705074`*^9, {3.6549775616405525`*^9, 
   3.6549775992035046`*^9}, {3.654977990335863*^9, 3.654977991507803*^9}, {
   3.6549784692077565`*^9, 3.6549784701453004`*^9}, {3.654978643225481*^9, 
   3.654978660350689*^9}, {3.654978696226063*^9, 3.65497871297631*^9}}],

Cell[BoxData[
 DynamicBox[
  ToBoxes[{$CellContext`upperBound, $CellContext`bestCandidate, \
$CellContext`marker}, StandardForm],
  ImageSizeCache->{730., {84., 12.}}]], "Output",
 CellChangeTimes->{
  3.615375515942048*^9, 3.615375546997072*^9, {3.6153759051071*^9, 
   3.615375930165852*^9}, 3.615376255776819*^9, 3.6153764347978067`*^9, 
   3.615376604715333*^9, {3.615387448507072*^9, 3.6153874650703254`*^9}, {
   3.615388299543171*^9, 3.615388324688115*^9}, {3.615388386220213*^9, 
   3.6153884298338084`*^9}, 3.615388640205166*^9, {3.6153911711569424`*^9, 
   3.6153911913959436`*^9}, 3.6153912835790653`*^9, 3.6153913662891097`*^9, 
   3.6153920011824026`*^9, {3.6153923524265633`*^9, 3.6153923843478603`*^9}, 
   3.615392423995654*^9, 3.615392466564023*^9, 3.6153925348024206`*^9, 
   3.615392682156412*^9, 3.6153947150109925`*^9, 3.6153948473407106`*^9, 
   3.615394952404462*^9, 3.6154905895849953`*^9, 3.6155033723026657`*^9, 
   3.6155036454841323`*^9, 3.6155047357862496`*^9, 3.6155048027108855`*^9, {
   3.6155048375646935`*^9, 3.615504840125516*^9}, 3.6155048866396255`*^9, 
   3.615505133195141*^9, {3.6549774261545053`*^9, 3.6549774534048433`*^9}, 
   3.6549775628436337`*^9, 3.6549775995315685`*^9, 3.6549779937265186`*^9, 
   3.6549784220509553`*^9, 3.6549784706765537`*^9, {3.6549786439285774`*^9, 
   3.6549786607568836`*^9}, {3.654978696991749*^9, 3.654978733273389*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.8125`6.784962879177635", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "13"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.615375515942048*^9, 3.615375546997072*^9, {3.6153759051071*^9, 
   3.615375930165852*^9}, 3.615376255776819*^9, 3.6153764347978067`*^9, 
   3.615376604715333*^9, {3.615387448507072*^9, 3.6153874650703254`*^9}, {
   3.615388299543171*^9, 3.615388324688115*^9}, {3.615388386220213*^9, 
   3.6153884298338084`*^9}, 3.615388640205166*^9, {3.6153911711569424`*^9, 
   3.6153911913959436`*^9}, 3.6153912835790653`*^9, 3.6153913662891097`*^9, 
   3.6153920011824026`*^9, {3.6153923524265633`*^9, 3.6153923843478603`*^9}, 
   3.615392423995654*^9, 3.615392466564023*^9, 3.6153925348024206`*^9, 
   3.615392682156412*^9, 3.6153947150109925`*^9, 3.6153948473407106`*^9, 
   3.615394952404462*^9, 3.6154905895849953`*^9, 3.6155033723026657`*^9, 
   3.6155036454841323`*^9, 3.6155047357862496`*^9, 3.6155048027108855`*^9, {
   3.6155048375646935`*^9, 3.615504840125516*^9}, 3.6155048866396255`*^9, 
   3.615505133195141*^9, {3.6549774261545053`*^9, 3.6549774534048433`*^9}, 
   3.6549775628436337`*^9, 3.6549775995315685`*^9, 3.6549779937265186`*^9, 
   3.6549784220509553`*^9, 3.6549784706765537`*^9, {3.6549786439285774`*^9, 
   3.6549786607568836`*^9}, {3.654978696991749*^9, 3.654978739101564*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"4", " ", "-", " ", "1", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"5", " ", "-", " ", "3", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"6", " ", "-", " ", "4", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"7", " ", "-", " ", "4", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"8", " ", "-", " ", "7", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"9", " ", "-", " ", "8", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "9"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"10", " ", "-", " ", "10", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "9"}], "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"11", " ", "-", " ", "12", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"12", " ", "-", " ", "15", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "8"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"13", " ", "-", " ", "19", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "12"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"14", " ", "-", " ", "22", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"15", " ", "-", " ", "26", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "14"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"16", " ", "-", " ", "30", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"7", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"17", " ", "-", " ", "35", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"12", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"12", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "8"}], "}"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"18", " ", "-", " ", "40", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"12", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"15", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"13", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"14", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "8"}], "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"19", " ", "-", " ", "44", " ", "-", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"12", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"15", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "15"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"12", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "14"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "11"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "19"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "17"}], "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"30", " ", "-", " ", 
    DynamicBox[
     ToBoxes[{$CellContext`upperBound, $CellContext`bestCandidate, \
$CellContext`marker}, StandardForm],
     ImageSizeCache->{673., {84., 12.}}]}], "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.6153752119854245`*^9, 3.615375214347103*^9}, {
  3.615392445804942*^9, 3.6153924516610746`*^9}, {3.615394784558694*^9, 
  3.6153948418093753`*^9}, {3.61539491777903*^9, 3.615394938591778*^9}, {
  3.6155048579181786`*^9, 3.615504897390275*^9}, {3.6155050785762444`*^9, 
  3.6155050898072386`*^9}, {3.615505371463916*^9, 3.6155053833078365`*^9}, {
  3.654978383481222*^9, 3.654978406550733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lower", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "2"], "-", 
        RowBox[{"3", "n"}]}], ")"}], "/", "8"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Ceiling", "@", 
       RowBox[{"lower", "[", "i", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3", ",", "20"}], "}"}]}], "]"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.6153749376128016`*^9, 3.6153749379190383`*^9}, {
  3.6153749997728934`*^9, 3.615375000168193*^9}, {3.615394749636405*^9, 
  3.615394749730154*^9}, {3.615503642891268*^9, 3.6155036432685366`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"3", "0"},
    {"4", "1"},
    {"5", "2"},
    {"6", "3"},
    {"7", "4"},
    {"8", "5"},
    {"9", "7"},
    {"10", "9"},
    {"11", "11"},
    {"12", "14"},
    {"13", "17"},
    {"14", "20"},
    {"15", "23"},
    {"16", "26"},
    {"17", "30"},
    {"18", "34"},
    {"19", "38"},
    {"20", "43"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6153749389747815`*^9, 3.6153750028110504`*^9, 
  3.615394851590746*^9, 3.6155036472413645`*^9}]
}, Open  ]]
},
Evaluator->"Kernel 2",
WindowSize->{893, 800},
WindowMargins->{{Automatic, 248}, {6, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 7365, 177, 732, "Input"],
Cell[7925, 199, 8897, 218, 1032, "Input"],
Cell[16825, 419, 2350, 50, 272, "Input"],
Cell[CellGroupData[{
Cell[19200, 473, 2340, 35, 72, "Input"],
Cell[21543, 510, 1394, 21, 112, "Output"],
Cell[22940, 533, 4606, 123, 149, "Output"]
}, Open  ]],
Cell[27561, 659, 21508, 652, 782, "Input"],
Cell[CellGroupData[{
Cell[49094, 1315, 817, 24, 54, "Input"],
Cell[49914, 1341, 928, 34, 282, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
